"use strict";const imgPlaceholder="https://via.placeholder.com/210x295/ffffff/666666/?text=TV",input=document.querySelector(".js-input"),searchBtn=document.querySelector(".js-search-btn"),resetBtn=document.querySelector(".js-reset-btn"),notFound=document.querySelector(".js-msg"),resetFavBtn=document.querySelector(".js-resetFavBtn"),cocktailsList=document.querySelector(".js-list-cocktails"),favouritesList=document.querySelector(".js-list-favourites");let cocktailsListData=[],favouritesListData=[];const storedCocktails=JSON.parse(localStorage.getItem("cocktails"));function addCocktails(t){fetch(t).then(t=>t.json()).then(t=>{t.drinks?(cocktailsListData=t.drinks,renderCocktailsList(cocktailsListData),notFound.innerHTML="",console.log("I fetch")):(notFound.innerHTML="¡Nos has pillado! Parece que no tenemos el coctel que estás buscando...",cocktailsListData=[],renderCocktailsList(cocktailsListData)),resetFavBtnHidden()})}function addSelected(t){null!==t&&t.classList.add("selected"),resetFavBtnHidden()}function removeSelected(t){null!==t&&t.classList.remove("selected"),resetFavBtnHidden()}function handleClickCocktail(t){const e=t.currentTarget.id,a=cocktailsListData.find(t=>t.idDrink===e),i=favouritesListData.findIndex(t=>t.idDrink===e);-1===i?(favouritesListData.push(a),addSelected(t.currentTarget)):(favouritesListData.splice(i,1),removeSelected(t.currentTarget)),renderCocktailsList(cocktailsListData),renderFavouritesList(favouritesListData),localStorage.setItem("cocktails",JSON.stringify(favouritesListData))}function renderCocktail(t){const e=favouritesListData.find(e=>e.strDrink===t.strDrink),a=document.createElement("li"),i=document.createElement("article"),s=document.createElement("h3"),c=document.createTextNode(t.strDrink),n=document.createElement("img");a.setAttribute("class","li js-li-cocktail "+(e&&"selected")),a.setAttribute("id",t.idDrink),i.setAttribute("class","li__article"),s.setAttribute("class","li__article--title"),n.setAttribute("src",t.strDrinkThumb||imgPlaceholder),n.setAttribute("class","li__article--img"),s.appendChild(c),i.appendChild(s),i.appendChild(n),a.appendChild(i),cocktailsList.appendChild(a)}function renderCocktailsList(t){cocktailsList.innerHTML="";for(const e of t)renderCocktail(e);addEventToCocktail()}function renderFavCocktail(t){const e=document.createElement("li"),a=document.createElement("article"),i=document.createElement("h3"),s=document.createElement("span"),c=document.createElement("img");e.setAttribute("class","liFav js-li-cocktail"),e.setAttribute("id",t.idDrink),a.setAttribute("class","liFav__article"),i.setAttribute("class","liFav__article--title");const n=document.createTextNode(t.strDrink);s.setAttribute("class","fa-solid fa-heart js-fav-btn"),s.addEventListener("click",handleClickFavBtn),c.setAttribute("src",t.strDrinkThumb||imgPlaceholder),c.setAttribute("class","liFav__article--img"),i.appendChild(n),i.appendChild(s),a.appendChild(i),a.appendChild(c),e.appendChild(a),favouritesList.appendChild(e)}function renderFavouritesList(t){favouritesList.innerHTML="";for(const e of t)renderFavCocktail(e)}function addEventToCocktail(){const t=document.querySelectorAll(".js-li-cocktail");for(const e of t)e.addEventListener("click",handleClickCocktail)}function resetFavBtnHidden(){favouritesListData&&favouritesListData.length>0?resetFavBtn.classList.remove("hidden"):resetFavBtn.classList.add("hidden")}function handleClearFavList(){favouritesListData=[],localStorage.removeItem("cocktails"),resetFavBtnHidden(),renderFavouritesList(favouritesListData),renderCocktailsList(cocktailsListData)}function handleClickFavBtn(t){const e=t.currentTarget.id,a=favouritesListData.findIndex(t=>t.idDrink===e);-1!==a&&favouritesListData.splice(a,1),renderFavouritesList(favouritesListData),renderCocktailsList(cocktailsListData),localStorage.setItem("cocktails",JSON.stringify(favouritesListData))}function handleClickReset(t){t.preventDefault(),cocktailsListData=[],favouritesListData=[],input.value="",localStorage.removeItem("cocktails"),renderFavouritesList(favouritesListData),renderCocktailsList(cocktailsListData)}function handleEnterSearch(t){"Enter"===t.key&&(t.preventDefault(),handleClickSearch(t))}function handleClickSearch(t){t.preventDefault(),cocktailsList.innerHTML="";addCocktails("https://www.thecocktaildb.com/api/json/v1/1/search.php?s="+input.value)}storedCocktails&&(favouritesListData=storedCocktails,renderFavouritesList(favouritesListData),console.log("I have LS")),addCocktails("https://www.thecocktaildb.com/api/json/v1/1/search.php?s=margarita"),resetFavBtn.addEventListener("click",handleClearFavList),resetBtn.addEventListener("click",handleClickReset),searchBtn.addEventListener("click",handleClickSearch),input.addEventListener("keypress",handleEnterSearch);